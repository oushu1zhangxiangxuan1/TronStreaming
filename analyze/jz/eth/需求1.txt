一. 以太坊查询SQL
SELECT 
 id       						AS "交易ID"			 		--交易ID
 ,transactionhash               AS "交易hash"				--交易hash
 ,blocknumber                   AS "所在区块号"				--所在区块号
 ,to_timestamp(timestamp1::int)	AS "交易时间"				--交易时间
 ,from1                         AS "发送方"					--来源地址
 ,to1                           AS "接收方"					--去向地址
 ,CASE WHEN value1 = 0 THEN 0 ELSE value1::decimal(8)/1000000000000000000 END   AS "交易量(单位:ETH)"		--交易量
 from orc_t_ethereum_nm_ta1 
 WHERE 
 transactionhash = '0x7ce598817b585e3015b145a26a0148b17ce48cef35192d3b05488d2186d5248a';


--1
SELECT 
 id       						AS "交易ID"			 		--交易ID
 ,transactionhash               AS "交易hash"				--交易hash
 ,blocknumber                   AS "所在区块号"				--所在区块号
 ,to_timestamp(timestamp1::int)	AS "交易时间"				--交易时间
 ,from1                         AS "发送方"					--来源地址
 ,to1                           AS "接收方"					--去向地址
 ,CASE WHEN value1 = 0 THEN 0 ELSE value1::decimal(8)/1000000000000000000 END   AS "交易量(单位:ETH)"		--交易量
 from orc_t_ethereum_nm_ta1 
 WHERE 
  from1 = '0x6efb20f61b80f6a7ebe7a107bace58288a51fb34'
 OR 
  to1 ='0x6efb20f61b80f6a7ebe7a107bace58288a51fb34';
 
--395299
 SELECT 
  count(*)
 from orc_t_ethereum_nm_ta1 
 WHERE 
  from1 = '0x6efb20f61b80f6a7ebe7a107bace58288a51fb34'
 OR 
  to1 ='0x6efb20f61b80f6a7ebe7a107bace58288a51fb34';

 B9C5C8D7E0583CDDE0503832314C06A9 | 0x4830f7185a6ae7a23583de084396684cb418b175e72178fc2284a58a930bdae1 | 8932775    | 2019-11-14 21:56:
05+08 | 0x6efb20f61b80f6a7ebe7a107bace58288a51fb34 | 0xe513ebb17c513d4c1c477b056739e41fc38ee6d7 |        62.0103372500000000
 B9C5C85D71BF3CDDE0503832314C06A9 | 0x083f6b27008c45cea35b829c5e6b5c686f66a350478c83c836f2b386fb4af126 | 8862236    | 2019-11-03 09:17:
02+08 | 0x6efb20f61b80f6a7ebe7a107bace58288a51fb34 | 0x5edc1a266e8b2c5e8086d373725df0690af7e3ea |                          0
 B9C5C62992F93CDDE0503832314C06A9 | 0xf17a5b3aeb4029636f97a1ae0d04af11051d1d79169ce0658b98478126fed111 | 8512126    | 2019-09-09 07:08:
02+08 | 0x6efb20f61b80f6a7ebe7a107bace58288a51fb34 | 0x2b7922fdf76fb3466902c7b702a20ea6a450a0a0 |                          0
 B9C5C2D9E69C3CDDE0503832314C06A9 | 0x383313f8cd2afc09ef8bbbc0fd08df3b518acb2862cd08d71b568c2e7511c38d | 8024992    | 2019-06-25 12:28:
11+08 | 0x6efb20f61b80f6a7ebe7a107bace58288a51fb34 | 0xeb6df2a67f5f67f3b04cc8cffe8b9676613d98ca |         3.6703864900000000
 B9C5C8F115423CDDE0503832314C06A9 | 0x48aba134561351503f77d0cfe0bd0af4a7dfab540b04ff713ded8688e4e4b7db | 8948834    | 2019-11-17 14:03:
19+08 | 0x6efb20f61b80f6a7ebe7a107bace58288a51fb34 | 0xa8b9cd2577d20224af856c19af20040290705932 |                          0
 B9C5C8FA110E3CDDE0503832314C06A9 | 0xf7048748ab585a5487a43541ffbd75d99005b517bf82a0338d96a7b7692a78aa | 8954416    | 2019-11-18 12:16:
15+08 | 0x6efb20f61b80f6a7ebe7a107bace58288a51fb34 | 0xa10519243bec391764458624e8d2d89fe00ec3b9 |         5.6321900900000000
 B9C5C53E80543CDDE0503832314C06A9 | 0x04cc3ed49dd129f1db6abfc0d0ac003340650a8fffb251106d35f96340b9a25e | 8374414    | 2019-08-18 20:37:
22+08 | 0x6efb20f61b80f6a7ebe7a107bace58288a51fb34 | 0x2b7922fdf76fb3466902c7b702a20ea6a450a0a0 |                          0
 B9C5C7F9DF353CDDE0503832314C06A9 | 0xda63f75a5a5f798b0a8bf5f76eb1d54fb4dcca002d7bd0874d11c028cb0f799d | 8803679    | 2019-10-24 23:11:
05+08 | 0x6efb20f61b80f6a7ebe7a107bace58288a51fb34 | 0xdac17f958d2ee523a2206206994597c13d831ec7 |                          0
 B9C5C656AB9C3CDDE0503832314C06A9 | 0x73b392d94ad4fd8d8826c744757f5f11696e84d490897d67c8ca423c821bd76c | 8538766    | 2019-09-13 10:52:
13+08 | 0x6efb20f61b80f6a7ebe7a107bace58288a51fb34 | 0x2b7922fdf76fb3466902c7b702a20ea6a450a0a0 |                          0
 B9C5C53B77A33CDDE0503832314C06A9 | 0x297a678ad68128e90405cfca798a22546774efec346963e6c7682ac86d4b578a | 8372675    | 2019-08-18 14:06:
04+08 | 0x6efb20f61b80f6a7ebe7a107bace58288a51fb34 | 0x03aa119cc70143f57b482afb96beb724609f52bf |                          0
 B9C5C5744A3B3CDDE0503832314C06A9 | 0xb2e46ff29bc955ebe366e6272021807b5d2b4b4ac56949e098dc45edfd14c86c | 8405706    | 2019-08-23 17:21:
51+08 | 0x6efb20f61b80f6a7ebe7a107bace58288a51fb34 | 0x2b7922fdf76fb3466902c7b702a20ea6a450a0a0 |                          0
 B9C5C46004AA3CDDE0503832314C06A9 | 0xb590d6241647ac55a21b40011a81dde6c0440e03295b0ce4e40d42deefad51bc | 8240465    | 2019-07-29 01:35:
03+08 | 0x6efb20f61b80f6a7ebe7a107bace58288a51fb34 | 0x354074fa53a199e73042e9726031cffc6c20d61b |                          0
 B9C5C5BFD83E3CDDE0503832314C06A9 | 0xd69edc957470776eb2dc5adabab2dcaf438b02dcd6371323f55d0b9951788886 | 8450151    | 2019-08-30 15:15:
09+08 | 0x6efb20f61b80f6a7ebe7a107bace58288a51fb34 | 0x2b7922fdf76fb3466902c7b702a20ea6a450a0a0 |                          0
 B9C5C5157F113CDDE0503832314C06A9 | 0xd64ff41ad0b86e006227791d1a192a38a2cb11881bfa642405ca8b073dc83926 | 8348899    | 2019-08-14 21:31:
03+08 | 0x6efb20f61b80f6a7ebe7a107bace58288a51fb34 | 0x2b7922fdf76fb3466902c7b702a20ea6a450a0a0 |                          0
 B9C5C51BE6323CDDE0503832314C06A9 | 0xa17fb81cf31eacde8e9f58b400b11cb96d80e7d0ad2997b0a74e9b7f228ff93b | 8353111    | 2019-08-15 12:58:
53+08 | 0x6efb20f61b80f6a7ebe7a107bace58288a51fb34 | 0x2b7922fdf76fb3466902c7b702a20ea6a450a0a0 |                          0
 B9C5C77A6D40327CE0503832314C06A7 | 0x6cffb82e939a0bc094e5161a81bdf98f94db801aa2e8596d0a770cd13b5e5f62 | 7896312    | 2019-06-05 09:32:
02+08 | 0x6efb20f61b80f6a7ebe7a107bace58288a51fb34 | 0xdac17f958d2ee523a2206206994597c13d831ec7 |                          0
 B9C5C5B4F10B3CDDE0503832314C06A9 | 0x6b5f6dbc54f854f090df24a907087942823f19c400a978d4c14fa3e408f6b551 | 8443679    | 2019-08-29 15:14:
56+08 | 0x6efb20f61b80f6a7ebe7a107bace58288a51fb34 | 0x2b7922fdf76fb3466902c7b702a20ea6a450a0a0 |                          0
 B9C5C6B7BA25327CE0503832314C06A7 | 0x2d84a987c69346b9678031416bd59f024baa7fe75855837a7edd64fe45109cdd | 7803586    | 2019-05-21 21:45:
00+08 | 0x6efb20f61b80f6a7ebe7a107bace58288a51fb34 | 0x174bfa6600bf90c885c7c01c7031389ed1461ab9 |                          0



--2
SELECT 
 id       						AS "交易ID"			 		--交易ID
 ,transactionhash               AS "交易hash"				--交易hash
 ,blocknumber                   AS "所在区块号"				--所在区块号
 ,to_timestamp(timestamp1::int)	AS "交易时间"				--交易时间
 ,from1                         AS "发送方"					--来源地址
 ,to1                           AS "接收方"					--去向地址
 ,CASE WHEN value1 = 0 THEN 0 ELSE value1::decimal(8)/1000000000000000000 END   AS "交易量(单位:ETH)"		--交易量
 from orc_t_ethereum_nm_ta1 
 WHERE 
  from1 = '0xc06b1f066a9ce833c685729f4d5bae20ebd6b099'
 OR 
  to1 ='0xc06b1f066a9ce833c685729f4d5bae20ebd6b099';
  
 B9C5C2B7A77C35B6E0503832314C0685 | 0xd2310d42eb2e39c0c4d36440ffa29ea557adfed4801093956f13491ebb983411 | 10313711   | 2020-06-22 13:37:
36+08 | 0xc06b1f066a9ce833c685729f4d5bae20ebd6b099 | 0xd8deaedd223a2150612c5c6f33609be89d553d9b |                                      
0
 B9C5C49757B635B6E0503832314C0685 | 0xb403a3a9b3cefe3ce82ebbd69929e3119c026ce748703932b12e0b616fcc94e5 | 10506089   | 2020-07-22 08:50:
09+08 | 0xc06b1f066a9ce833c685729f4d5bae20ebd6b099 | 0xea892f1afc02aeea6f3fc5253d6ccefa0045b177 |                 0.0041000001459000000
0
 B9C5C7D2BE5E35B6E0503832314C0685 | 0x5351fdafc59ff4040ce6c3b9be5c7a19b21fc8831bbcbba0f9a3b8113d5e76bf | 10804892   | 2020-09-06 09:14:
23+08 | 0xc06b1f066a9ce833c685729f4d5bae20ebd6b099 | 0x5703840e9ae9ff88c25af351e465a163674f27b2 |                                      
0
 B9C5C77A840FB44AE0503832314C06A5 | 0xa53207794a752bf64213d38b5e8e68c29afac50492c311de2cae79d9c4b0667e | 9673612    | 2020-03-15 11:25:
00+08 | 0xc06b1f066a9ce833c685729f4d5bae20ebd6b099 | 0x1ac0f18b96f8ecd48c909cd1a8d28ba0653c1e86 |                                      
0
 B9C5C5F8225935B6E0503832314C0685 | 0x99bbbee8f4b973b65fd42c808df102ad9e8c729ee40c2987a6b03840a23718ab | 10632108   | 2020-08-10 20:20:
15+08 | 0xc06b1f066a9ce833c685729f4d5bae20ebd6b099 | 0x368a0152060624413325940de7f88ee54140fa91 |             0.00009999999999999900000
0
 B9C5C8A4EF69B44AE0503832314C06A5 | 0xb50fc3cce1ffcc3b68ed6df4d708034b47d63a181e121fd8861312443cc54ba2 | 9843590    | 2020-04-10 16:55:
18+08 | 0xc06b1f066a9ce833c685729f4d5bae20ebd6b099 | 0x1efac82baa7ba9915e9fbdc7f411d8eab72dc5a3 |                 0.0010000000000000000
0
 B9C5C700C7A7B44AE0503832314C06A5 | 0xc4017557d9db8cca5544da783b2e1ab56142025de00c593485c1c8380aeff1da | 9601589    | 2020-03-04 09:00:
06+08 | 0xc06b1f066a9ce833c685729f4d5bae20ebd6b099 | 0x7f3581492d73241bddf18b74ba7810bb7f9796f7 |                 0.0005000000000000000
0
 B9C5C0E7BF4335B6E0503832314C0685 | 0xee751962602742a10c04e580d2242c4aa1d3e3427bae04908590ab13334fc08c | 10097058   | 2020-05-19 23:10:
21+08 | 0xc06b1f066a9ce833c685729f4d5bae20ebd6b099 | 0x577e0dd29e6bd3bf05a41988d30b207c37583cc8 |                 0.0038000000000000000
0
 B9C5C3B7A82635B6E0503832314C0685 | 0x137810e587620c36cdbf54be424c57bec02b6fe36be93e6e53f59375cac2ec9b | 10418190   | 2020-07-08 17:50:
26+08 | 0xc06b1f066a9ce833c685729f4d5bae20ebd6b099 | 0xbead3a1cd9abffa789160c2d62fd351236a54bbc |                 0.0056000001459000000
0
 B9C5C25B0FC335B6E0503832314C0685 | 0xd198c9afeaa691c225593690d64b09950664a2a39b0b142446f997564fa99323 | 10271306   | 2020-06-16 00:07:
39+08 | 0xc06b1f066a9ce833c685729f4d5bae20ebd6b099 | 0xd8deaedd223a2150612c5c6f33609be89d553d9b |                                      
0
 B9C5C02AAA5535B6E0503832314C0685 | 0xa114507b94e9cef332b83d70dcd6ae012be4bb2c6142133794b4c1f8dfc65fec | 10004659   | 2020-05-05 14:39:
58+08 | 0xc06b1f066a9ce833c685729f4d5bae20ebd6b099 | 0xaacc5063ea5dffa42c225870bcff3e01c31bf956 |                 0.0011000000000000000
0
 B9C5C2B4674835B6E0503832314C0685 | 0xbc05891a36522777b9e9a893880bd5c9d80466338d38934f849924a06cbf3fa2 | 10312444   | 2020-06-22 08:48:
00+08 | 0xc06b1f066a9ce833c685729f4d5bae20ebd6b099 | 0xd8deaedd223a2150612c5c6f33609be89d553d9b |                                      
0
 B9C5C801E3B835B6E0503832314C0685 | 0xe89eaa6b4d681eb750532de1695e108a8d11584e9ab0cc69b42086a65bedea0d | 10824360   | 2020-09-09 08:46:
12+08 | 0xc06b1f066a9ce833c685729f4d5bae20ebd6b099 | 0x5703840e9ae9ff88c25af351e465a163674f27b2 |                                      
0
 B9C5C055E50D35B6E0503832314C0685 | 0x5f10a2fc981f08933e698546cfcdfa24178d9aa68a5ec308a0b2c1d702d0d12c | 10026082   | 2020-05-08 22:20:
18+08 | 0xc06b1f066a9ce833c685729f4d5bae20ebd6b099 | 0xef50fe4e5b53fb9d5fc2914cad88e8d145f29c19 |                 0.0019000000000000000
0


  
--12569
 SELECT 
  count(*)
 from orc_t_ethereum_nm_ta1 
 WHERE 
  from1 = '0xc06b1f066a9ce833c685729f4d5bae20ebd6b099'
 OR 
  to1 ='0xc06b1f066a9ce833c685729f4d5bae20ebd6b099';


--3

SELECT 
 id       						AS "交易ID"			 		--交易ID
 ,transactionhash               AS "交易hash"				--交易hash
 ,blocknumber                   AS "所在区块号"				--所在区块号
 ,to_timestamp(timestamp1::int)	AS "交易时间"				--交易时间
 ,from1                         AS "发送方"					--来源地址
 ,to1                           AS "接收方"					--去向地址
 ,CASE WHEN value1 = 0 THEN 0 ELSE value1::decimal(8)/1000000000000000000 END   AS "交易量(单位:ETH)"		--交易量
 from orc_t_ethereum_nm_ta1 
 WHERE 
  from1 = '0xaf65ad4d4aca60e96c5b524240f66762bb043070'
 OR 
  to1 ='0xaf65ad4d4aca60e96c5b524240f66762bb043070';
  
              交易ID              |                              交易hash                              | 所在区块号 |        交易
间        |                   发送方                   |                   接收方                   |    交易量(单位:ETH)    
----------------------------------+--------------------------------------------------------------------+------------+-------------
-----------+--------------------------------------------+--------------------------------------------+------------------------
 B9C5C50FC91781F7E0503832314C0683 | 0xbb7435f6c390eed8330c60f035feb4dc1e179f097e51b45a655a7f4e540e3fc7 | 6696860    | 2018-11-13 2
0:34:23+08 | 0xaf65ad4d4aca60e96c5b524240f66762bb043070 | 0x3401cab9bee49bcb76e13a8a09619e53d45c0af0 |                      0
 B9C5C5B4104E81F7E0503832314C0683 | 0x175079074a30d946b6b460e1140728c67ca7eb6833278383a4cabb52c4ad7a20 | 6814597    | 2018-12-03 0
5:02:03+08 | 0xaf65ad4d4aca60e96c5b524240f66762bb043070 | 0x3401cab9bee49bcb76e13a8a09619e53d45c0af0 |                      0
 B9C5C5B54EB881F7E0503832314C0683 | 0xe28a28845aa24a6464e3d815882a5f4690d4bbeb2ae877017c317779773ebf3f | 6815750    | 2018-12-03 0
9:33:57+08 | 0xaf65ad4d4aca60e96c5b524240f66762bb043070 | 0x3401cab9bee49bcb76e13a8a09619e53d45c0af0 | 0.00158000000000000000
 B9C5C50A563481F7E0503832314C0683 | 0x570439ef6b985af61932899c8354bd70c33cc625e90fc7169c469b973cd327be | 6693214    | 2018-11-13 0
6:10:03+08 | 0xe50368f101bad9016b62fc61ac520c5c25a124f3 | 0xaf65ad4d4aca60e96c5b524240f66762bb043070 | 0.00800000000000000000
 B9C5C53125F481F7E0503832314C0683 | 0x716d0c0c3e5682ccae9f25dcb335d72e7eda54fe5dfc347485c9401b037e00c7 | 6721056    | 2018-11-17 1
9:40:00+08 | 0xaf65ad4d4aca60e96c5b524240f66762bb043070 | 0x06a6a7af298129e3a2ab396c9c06f91d3c54aba8 |                      0
 B9C5C5CECCDB81F7E0503832314C0683 | 0xdd9af04ec918e682df6563c24236d0d7713baedfe5922b6d4ddb88b017d6a089 | 6833359    | 2018-12-06 0
7:35:56+08 | 0xaf65ad4d4aca60e96c5b524240f66762bb043070 | 0x06a6a7af298129e3a2ab396c9c06f91d3c54aba8 |                      0
 B9C5C57FF1D081F7E0503832314C0683 | 0x236ee00006fd5d998106b4a0fb9f7a74b0a209ef5cc2d4be9e280f4c637d6121 | 6777602    | 2018-11-27 0
2:16:18+08 | 0xaf65ad4d4aca60e96c5b524240f66762bb043070 | 0x330eb7adace78769a23c2cef0ced00ce8e8e9131 | 0.01500000000000000000
 B9C5C557846081F7E0503832314C0683 | 0x29956cc2546289ba4de13bb4109a5405f2a8cdbcf0671f0364879eccf4285332 | 6747902    | 2018-11-22 0
5:37:09+08 | 0xaf65ad4d4aca60e96c5b524240f66762bb043070 | 0x3401cab9bee49bcb76e13a8a09619e53d45c0af0 |                      0
 B9C5C51BFA4E81F7E0503832314C0683 | 0xa0410d3421fe58da2e7c24aa4b5df7458e7fc64cd0d8a31d91adc6850f1696f3 | 6705717    | 2018-11-15 0
7:26:56+08 | 0xaf65ad4d4aca60e96c5b524240f66762bb043070 | 0x3401cab9bee49bcb76e13a8a09619e53d45c0af0 |                      0
 B9C5C576C45B81F7E0503832314C0683 | 0x4a81f40fce9da51ae0a585d035ed1eadbf31a0214cd94f35964e67c9153d3bae | 6770968    | 2018-11-26 0
0:06:24+08 | 0xaf65ad4d4aca60e96c5b524240f66762bb043070 | 0x3401cab9bee49bcb76e13a8a09619e53d45c0af0 | 0.00100000000000000000
 B9C5C4FE008781F7E0503832314C0683 | 0xc1bd09660701c938f47046af2d68a32f08932301564c65f116d6a4ac098da188 | 6684196    | 2018-11-11 1
9:04:52+08 | 0xe50368f101bad9016b62fc61ac520c5c25a124f3 | 0xaf65ad4d4aca60e96c5b524240f66762bb043070 | 0.00500000000000000000
 B9C5C5696E6481F7E0503832314C0683 | 0xe9668791a095daa4e9cf570a6aa75087357308613d0c19a4bf04ef4930cb913d | 6760771    | 2018-11-24 0
8:12:06+08 | 0xaf65ad4d4aca60e96c5b524240f66762bb043070 | 0x3401cab9bee49bcb76e13a8a09619e53d45c0af0 |                      0
 B9C5C578587A81F7E0503832314C0683 | 0xfbdd45dd82a5e0cfa9e6650d74e7f712ea8e588917547cbc3ee60555bf455641 | 6772294    | 2018-11-26 0
5:18:27+08 | 0xaf65ad4d4aca60e96c5b524240f66762bb043070 | 0x3401cab9bee49bcb76e13a8a09619e53d45c0af0 | 0.00100000000000000000
 B9C5C5CEC79481F7E0503832314C0683 | 0x388d649e850ae14a7faf978e36318b5de151b6b74bc2745aaf0ecb59b7af9eb7 | 6833338    | 2018-12-06 0
7:31:32+08 | 0xaf65ad4d4aca60e96c5b524240f66762bb043070 | 0x06a6a7af298129e3a2ab396c9c06f91d3c54aba8 |                      0
 B9C5C54D57BE81F7E0503832314C0683 | 0x238647ca4d5bec0a5c0f565cb9b9c21cdecdc86de97ead8e3e9693990ce08540 | 6740873    | 2018-11-21 0
1:54:40+08 | 0xaf65ad4d4aca60e96c5b524240f66762bb043070 | 0x3401cab9bee49bcb76e13a8a09619e53d45c0af0 |                      0

  
--107
 SELECT 
  count(*)
 from orc_t_ethereum_nm_ta1 
 WHERE 
  from1 = '0xaf65ad4d4aca60e96c5b524240f66762bb043070'
 OR 
  to1 ='0xaf65ad4d4aca60e96c5b524240f66762bb043070';
  
  
  
二. 波场
-- 波场交易输出表结构
CREATE TABLE tron_trans(
    trans_id text, -- 交易id或交易hash
    block_num bigint, -- 所在区块号
    trans_time timestamp, -- 交易时间
    trans_type text, -- trc10,20或者asset_name,
	is_trx boolean,
    from_address text, --来源地址
    to_address text, -- 去向地址
    amount bigint -- 交易量
);


1. transfer_contract

-- transfer_contract 225977939行
-- transfer_asset_contract 170418461
-- trans 1757560028行

1）310行

SELECT 
    a.trans_id AS trans_id,
    b.block_num AS block_num,
	to_timestamp(b.trans_time/1000) + interval '2 second' AS trans_time,
    'TRC-10' AS trans_type,
	true as is_trx,
    a.owner_address as from_address,
    a.to_address as to_address,
    CASE WHEN a.amount = 0 THEN 0 ELSE a.amount::decimal /1000000  END  
FROM
	(
	SELECT trans_id, owner_address, to_address, amount
	 FROM 
	 transfer_contract
	WHERE
	 owner_address ='TKQFpWs2GVFvjWW5xngLBirqgES4JJUdDH'
	 OR
	 to_address = 'TKQFpWs2GVFvjWW5xngLBirqgES4JJUdDH'
 	) a
    LEFT JOIN
    trans b
	ON
	a.trans_id = b.id
	
union

SELECT 
    a.trans_id AS trans_id,
    b.block_num AS block_num,
    to_timestamp(b.trans_time/1000)+ interval '2 second' AS trans_time,
    CASE WHEN  a.asset_name !~'^[0-9]+$' THEN  a.asset_name 
	     ELSE  c.name  END AS trans_type,					
	false as is_trx,
    a.owner_address as from_address,
    a.to_address as to_address,
    CASE WHEN a.amount = 0 THEN 0 ELSE a.amount::decimal /1000000  END  
FROM
(
 SELECT 
  trans_id,
  asset_name,
  owner_address,
  to_address,
  amount
  FROM
    transfer_asset_contract
  WHERE 
    owner_address ='TKQFpWs2GVFvjWW5xngLBirqgES4JJUdDH' 
    OR  
	to_address = 'TKQFpWs2GVFvjWW5xngLBirqgES4JJUdDH'
)	a 	
	LEFT JOIN
	asset_issue_v2 c
	ON 
	a.asset_name = c.id
    LEFT JOIN 
    trans b 
	ON
	a.trans_id = b.id
;

                             trans_id                             | block_num |       trans_time       | trans_type | is_trx |    
        from_address            |             to_address             |            case            
------------------------------------------------------------------+-----------+------------------------+------------+--------+----
--------------------------------+------------------------------------+----------------------------
 0241425716a85c02fce8e5ab4a292c1e6ef0bd59dc94f70d5c365c82fc2436f6 |  28364267 | 2021-03-12 01:38:03+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TF4S7KCmgDm3ACcefzVso9WMQJTLTLuRxK | 0.000001000000000000000000
 220c328360a6911c5d5f51404f4c41954f0a32de2016528a19003cb327e9faea |  29187508 | 2021-04-10 02:03:20+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TBfiy2m4VQPfAkcjSZ6nxP6PrAENYHcFDV | 0.000001000000000000000000
 3685a0d64f828a97b62d799b266bf5629c2683670cd2190a4e3bc1510e89418b |  29377076 | 2021-04-16 17:40:55+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TK6nCd5Tc1QEjDgMNjKnNofsqueCd5TyRL | 0.000001000000000000000000
 a52b586e0ff066e295f2124b00c873cf374f92f3846fbe9fc4bfddd2808bf48e |  28593596 | 2021-03-20 00:58:52+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TNSa3eRXXXaahRRXA7sSNRfSZax1vgZcf6 | 0.000001000000000000000000
 1da8ea6e8d11b3cbea15ce6b90b4e7091379f76833fe6ed04448c26da2e32266 |  28593594 | 2021-03-20 00:58:48+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TQJh5q6Yqu9MuET2A5ZyiFr6NBTwH4i2eg | 0.000001000000000000000000
 2b77fc6d8e531b24958b17bce6ca0dd8db7477e963365108946a32832b31a88a |  29150283 | 2021-04-08 18:03:51+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TB7qbE2FVSkWV1juqccrYFmhxN3NXuZjZU | 0.000001000000000000000000
 3c56d3849923fb41872d3fe494d3e0a072e8dfc863ebb3898d81116841961484 |  28152608 | 2021-03-04 16:51:11+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TUbscwSpV58eMSmv583bMNtWDU787EYEyY | 0.000001000000000000000000
 0471cb1f7db6fed767e67e809d34e59cba28c2c6900fd7a08dd3c5bb93afabb8 |  27916059 | 2021-02-24 11:16:19+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TYSAouAhHbZm5y8un8KnF8inVVqcrLcJ9D | 0.000001000000000000000000
 07042fbc106ee8e3a37f14a91b78fb907c73cc4c5837eb199ac15015cacb1190 |  27916072 | 2021-02-24 11:16:59+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TNku3AMPJBcLXu7u9fZ7w5tSscf3NbdVxE | 0.000001000000000000000000
 424da7cfaafb3038ff4a1b4c7ad3baaf9a849f500d856d3d70f46d3a7926d472 |  28364284 | 2021-03-12 01:38:56+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TLMEtH1MjLCffqHoSeZvXebp8eJncVLide | 0.000001000000000000000000
 8d973b6d71e2320009e4dc0e433acfb87d77228e36bac86388c9a8d6aebeb7c8 |  29470608 | 2021-04-20 01:33:32+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TEQYJgMHN1MCfen4PJJ3ZGjuDTfFSbQajC | 0.000001000000000000000000
 ec864c2cf754ebab46f28aa3bcad015428da2eb08dd9eaca7114977b5000f1a6 |  29570615 | 2021-04-23 12:59:02+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TKUor2smDPuLhaKE4mWHJ6CQjqx94dvmfu | 0.000001000000000000000000
 0eda0df764fad5951ae6bf13507b16e4fd115746d1e841e4d70e239841f13e33 |  28621066 | 2021-03-20 23:53:34+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TC4gNRESNPrdA2kyrnnWFPADC1g6bs6jzx | 0.000001000000000000000000
 7937ba570bbf0bb814fe9e8dc8829b10a9cb61bd1369a84547fd3f85400b4a44 |  28493607 | 2021-03-16 13:31:11+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TKDBYj2uvnN8xqbtX91Lhp9XrM8FUbpeVD | 0.000001000000000000000000
 a72d93d60037895a86abaa97b16f5514598b704784ef9952df7d61ece2f2818e |  27958405 | 2021-02-25 22:36:17+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TD8AwY8q4tqRhfqCXmumJjaDgr5YauKNB1 | 0.000001000000000000000000
 acb59f4c9f3e45dd78f73cef59a3b52e33704c5d6dbc5eaeac8c2b9b5b1d2703 |  28434544 | 2021-03-14 12:15:16+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TY5FuatFkmoeZn7YGiZ5oD3hC4uTQyyyXz | 0.000001000000000000000000
 c30ffcadca273a0b7e93ea9f6eb1b449d67819505ae71c45d6235c9cc53bb447 |  29377074 | 2021-04-16 17:40:47+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TLSUcKbM4Dk7TznirimAMn6sbXhjRud9tH | 0.000001000000000000000000
 03ce1d6fe872c3a6fb26f630399f30c8ab7c58d8aa893ec1e353a9bc27792f0b |  29150278 | 2021-04-08 18:03:33+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TXmp55hKxcbnKZogtsqMZ3AbKdPXD3SdxZ | 0.000001000000000000000000
 2af6351acbaae31c6123bdc05e3c5942b26e3545b5b6339b97a5d79212decaae |  29441812 | 2021-04-19 01:32:03+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TWkpHQU5JFhfLtFKmngmDuZL2ojrVoNoKN | 0.000001000000000000000000
 4e28f7e053515039a75bac84e213d6d0316fe08d9813a08126cf97ef96b549f0 |  28133789 | 2021-03-04 00:56:46+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TSrPbtK2W3RikMjQ364HVhhhxyeXjC7jNL | 0.000001000000000000000000
 4fa544efea7b09faa860d3cc8a0052a6716e44eedfb4ff1f92cdd9f8d362433e |  28593585 | 2021-03-20 00:58:18+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TLGhQLPiWpE6HaRTiSHCtkQS6v4VSRt2aT | 0.000001000000000000000000
 534616c8ab0825eb4a24868009fd80d1a0e9d2ad6b54fa86f3e59097ddad073c |  28152599 | 2021-03-04 16:50:43+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TEDtAn6nMupKxcFQekBoxUG8Ssc91WzuKr | 0.000001000000000000000000
 799d0e3957a8c55bf4547f11694943a5b090a1d03a6b7b14ce9310e73833044f |  28722695 | 2021-03-24 12:40:25+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TECkz98F6dngm2sezMAnG8owcNdCZbqhid | 0.000001000000000000000000
 ac50962b27393220964491cfec8c0ad585afe6b293d80fedca0188d529d4f45b |  29441745 | 2021-04-19 01:28:39+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TVmDc3VofAJa6VdyuUUKW8jkpxicwtQxiC | 0.000001000000000000000000
 ad18822ac26a2ff07b4b2b49e5a4624fd42dc9c439891d18dc579485e423a71c |  29274314 | 2021-04-13 02:26:59+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TBafUxXcQeBjXrqeDAAYhWFHp1MzXn2WH1 | 0.000001000000000000000000
 b54f7136c670f02a1f0b595dbf89ead848ab98002e0e52db080775e64ec56767 |  29146044 | 2021-04-08 14:14:51+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TPu2owJ9fdMdDdZRi4jtEvnS965ScDMhUA | 0.000001000000000000000000
 e8b2ca673cd2af71da5a758f4cfaa4ab7ce1b7fd4dfd3e5d8a1625f2a1a16dc1 |  28997042 | 2021-04-03 01:42:24+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TGBXmYwvGpHbSHTDyZ2yzbfLXMEAoHdV9u | 0.000001000000000000000000
 30136d9cd7c8acb9e8ae63bd98a70224456d67eebb9af674d824417e75d8d61c |  29528018 | 2021-04-22 01:27:01+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TL1pC97F56Heag6iGDHLLdjCxc1D2XftiW | 0.000001000000000000000000
 432f4a208b893aa856795914d185d9b15c422a1d7ff4d12e51dc5b2f60246694 |  28997131 | 2021-04-03 01:46:54+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TQgMSJfBwQAVXfcSXNU3jcDbRDERmBGgeD | 0.000001000000000000000000
 48e390516c200523cf23cee0592efe8ca980badb9bc0f8d926bd7301629cdcb8 |  28508540 | 2021-03-17 01:58:19+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TQvoRWytu4sobivzePtfYGBANwAKct12Pc | 0.000001000000000000000000
 5fd5625600927e2eb62c261e94c04d500074e5582200bdaa98cd3ca5b2ea45b6 |  29617377 | 2021-04-25 03:59:04+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TNpdtG4TgztpdwMYKnEQX3Uy9S37Pk2Zvq | 0.000001000000000000000000
 7134313c6267bbc71d82391ab922e0693b6ce5243d4fd09dfdfa0e5c37aa2882 |  29470613 | 2021-04-20 01:33:46+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TNCk6TzKsqDZTm3mhq58foPnHmZP4yyjBi | 0.000001000000000000000000
 8b4dfadaaf336a3e9d3fc2306957d96a6daf1b2e176fcf482a230b149eac6bbd |  29441779 | 2021-04-19 01:30:23+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TQwx9U7ENwBWacLdLPwewxa2AspziNW7qo | 0.000001000000000000000000
 955bc90661135169a919c07ea5ff64854f533c727729e717ead467ef85fde992 |  29470611 | 2021-04-20 01:33:42+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TYpjUhVuMXfAkYsCqn64bX3CQsFRqt78Fi | 0.000001000000000000000000
 bbc2ce223c4d883efe30bf2400f0b44d646397babdc3f28a6875375d22e91814 |  28833175 | 2021-03-28 08:49:37+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TYHCVU9W5HSSNAyDhX19WHTb9HRNfQrfB6 | 0.000001000000000000000000
 c4a4bc9770059ce572fe96823f6fcfba0752f376f02c402bb4dec573e0df56e2 |  29077051 | 2021-04-06 00:01:19+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TUVS9i5aCPuK8CVk7HXFQzP1gAA64tHGaW | 0.000001000000000000000000
 191c89b19d02b880e8e289b8c77de0c7c900990ef22c95d2ab92df4399903e06 |  29470616 | 2021-04-20 01:33:55+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TJ5yNoYmTv5rFxzhhk6oNq8sqsiTB1vEvd | 0.000001000000000000000000
 2e584fa67e3ca0ff42c289eea47c735b44e95758fcab3b5fec6093302df4269b |  29245257 | 2021-04-12 02:13:00+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TW4wSxfnGh7bz8MjNLvEMmEjciUaNxjd9M | 0.000001000000000000000000
 75e5ac99497a24ed90534794f5a7560209641bf644296128141608d476dc825c |  29441815 | 2021-04-19 01:32:10+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TGDZ2ZcqmwCLHSXXw3FFbZNFyA9gXzRDKs | 0.000001000000000000000000
 87098c65d55ef4793da005023f25140b316d7f2cc686f3f71843047179463f79 |  29215685 | 2021-04-11 01:33:15+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TNhhq93qqXsNThqsJYcsuUkAHAvUt71hsy | 0.000001000000000000000000
 aed96cdcd243d6c8728e18fd9a570849a7c514aa0aa90fed29b2f6646969bba1 |  28364264 | 2021-03-12 01:37:56+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TXc7p4Gd4cvdkDDyEPMeXqGT5C7YHvxHX7 | 0.000001000000000000000000
 ba92fe00e4b0da9cb86523c9fbdd80cb727fcd95d1fab03c12f81decb0f914e1 |  28450031 | 2021-03-15 01:10:00+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TSjnginbRahqJALaiZGunHdcpoSKzmCNsJ | 0.000001000000000000000000
 bf17b3a61cb1ccbb1d68308c2db3ad55ad68e4529aad2edaa4f38fbbafa6cb24 |  28493580 | 2021-03-16 13:29:49+08 | TRC-10     | t      | TKQ
FpWs2GVFvjWW5xngLBirqgES4JJUdDH | TX49ftxkizT1Jjj2ASynJJEafjVw7LM1y4 | 0.000001000000000000000000


2）
SELECT 
    a.trans_id AS trans_id,
    b.block_num AS block_num,
	to_timestamp(b.trans_time/1000) + interval '2 second' AS trans_time,
    'TRC-10' AS trans_type,
	true as is_trx,
    a.owner_address as from_address,
    a.to_address as to_address,
    CASE WHEN a.amount = 0 THEN 0 ELSE a.amount::decimal /1000000  END    
FROM
	(
	SELECT trans_id, owner_address, to_address, amount
	 FROM 
	 transfer_contract
	WHERE
	 owner_address ='TAFG2Bzb292csNojNM8LNMBPgQv75nee6X'
	 OR
	 to_address = 'TAFG2Bzb292csNojNM8LNMBPgQv75nee6X'
 	) a
    LEFT JOIN
    trans b
	ON
	a.trans_id = b.id
	
union

SELECT 
    a.trans_id AS trans_id,
    b.block_num AS block_num,
    to_timestamp(b.trans_time/1000)+ interval '2 second' AS trans_time,
    CASE WHEN  a.asset_name !~'^[0-9]+$' THEN  a.asset_name 
	     ELSE  c.name  END AS trans_type,					-- TODO: 查看内部数数字还是真实的asset_name
	false as is_trx,
    a.owner_address as from_address,
    a.to_address as to_address,
    CASE WHEN a.amount = 0 THEN 0 ELSE a.amount::decimal /1000000  END  
FROM
(
 SELECT 
  trans_id,
  asset_name,
  owner_address,
  to_address,
  amount
  FROM
    transfer_asset_contract
  WHERE 
    owner_address ='TAFG2Bzb292csNojNM8LNMBPgQv75nee6X' 
    OR  
	to_address = 'TAFG2Bzb292csNojNM8LNMBPgQv75nee6X'
)	a 	
	LEFT JOIN
	asset_issue_v2 c
	ON 
	a.asset_name = c.id
    LEFT JOIN 
    trans b 
	ON
	a.trans_id = b.id
;
	
3）


--
SELECT
 a.id ,
 b.name_
 FROM 
 transfer_asset_contract a 
 JOIN 
 asset_issue_contract b
 ON a.id = b.trans_id
 

SELECT
 asset_name,
 CASE WHEN asset_name ~'^[0-9]' THEN 'true' 
 ELSE 'false' END  as "是否是数字"
 FROM
 transfer_asset_contract;
 
 SELECT
 

-- asset_issue_contract
SELECT 
    id AS asset_id, 
    name_ AS asset_name
FROM asset_issue_contract;
-- 1. check  asset_id is unique
-- 2. check asset_name is unique
-- 3. check (asset_id, asset_name) is unique
-- 4. check asset_id is number
